<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Agents Building Blocks" />
<meta property="og:locale" content="en" />
<meta name="description" content="title: “Agents building blocks” description: &gt;- Agents building blocks. author: lso date: 2025-02-14 11:08:03 +0200 categories: [Blogging, Tutorial] tags: [agents,llm] pin: false media_subpath: ‘/posts/20250214’ —" />
<meta property="og:description" content="title: “Agents building blocks” description: &gt;- Agents building blocks. author: lso date: 2025-02-14 11:08:03 +0200 categories: [Blogging, Tutorial] tags: [agents,llm] pin: false media_subpath: ‘/posts/20250214’ —" />
<link rel="canonical" href="http://localhost:4000/posts/Agents-Building-blocks/" />
<meta property="og:url" content="http://localhost:4000/posts/Agents-Building-blocks/" />
<meta property="og:site_name" content="Laurentiu SOICA" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-14T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Agents Building Blocks" />
<meta name="twitter:site" content="@lsoica" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-02-14T00:00:00+02:00","datePublished":"2025-02-14T00:00:00+02:00","description":"title: “Agents building blocks” description: &gt;- Agents building blocks. author: lso date: 2025-02-14 11:08:03 +0200 categories: [Blogging, Tutorial] tags: [agents,llm] pin: false media_subpath: ‘/posts/20250214’ —","headline":"Agents Building Blocks","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Agents-Building-blocks/"},"url":"http://localhost:4000/posts/Agents-Building-blocks/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Agents Building Blocks | Laurentiu SOICA
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Laurentiu SOICA">
<meta name="application-name" content="Laurentiu SOICA">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/lsoica.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Laurentiu SOICA</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0"></p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/lsoica"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/lsoica"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['laurentiu','soica.ro'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Agents Building Blocks</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Agents Building Blocks</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739484000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 14, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/lsoica">Laurentiu SOICA</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="5270 words"
>
  <em>29 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    
<p>title:  “Agents building blocks”
description: &gt;-
  Agents building blocks.
author: lso
date:   2025-02-14 11:08:03 +0200
categories: [Blogging, Tutorial]
tags: [agents,llm]
pin: false
media_subpath: ‘/posts/20250214’
—</p>

<h2 id="what-is-an-agent"><span class="me-2">What is an agent?</span><a href="#what-is-an-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>An agent is an AI model capable of reasoning, planning, and interacting with its environment. We call it Agent because it has agency, aka it has the ability to interact with the environment.</p>

<p>The main steps of an agent are:</p>
<ul>
  <li>Reasoning</li>
  <li>Planning</li>
  <li>Action Execution by using tools</li>
</ul>

<h2 id="agents-brain---the-llm"><span class="me-2">Agent’s brain - the LLM</span><a href="#agents-brain---the-llm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Most LLMs nowadays are built on the Transformer architecture—a deep learning architecture based on the “Attention” algorithm, that has gained significant interest since the release of BERT from Google in 2018.</p>

<p>There are 3 types of transformers :</p>

<ol>
  <li>Encoder: An encoder-based Transformer takes text (or other data) as input and outputs a dense representation (or embedding) of that text. Use Cases: Text classification, semantic search, Named Entity Recognition.</li>
  <li>Decoder: A decoder-based Transformer focuses on generating new tokens to complete a sequence, one token at a time. Use Cases: Text generation, chatbots, code generation</li>
  <li>Seq2Seq (Encoder–Decoder): A sequence-to-sequence Transformer combines an encoder and a decoder. The encoder first processes the input sequence into a context representation, then the decoder generates an output sequence. Use Cases: Translation, Summarization, Paraphrasing.</li>
</ol>

<p>Although Large Language Models come in various forms, LLMs are typically decoder-based models with billions of parameters.</p>

<p>The underlying principle of an LLM is simple yet highly effective: its objective is to predict the next token, given a sequence of previous tokens. A “token” is the unit of information an LLM works with. You can think of a “token” as if it was a “word”, but for efficiency reasons LLMs don’t use whole words.</p>

<p>For example, while English has an estimated 600,000 words, an LLM might have a vocabulary of around 32,000 tokens (as is the case with Llama 2). Tokenization often works on sub-word units that can be combined.</p>

<p>Each LLM has some special tokens specific to the model. The LLM uses these tokens to open and close the structured components of its generation. For example, to indicate the start or end of a sequence, message, or response. Moreover, the input prompts that we pass to the model are also structured with special tokens. The most important of those is the End of sequence token (EOS).</p>

<p>LLMs are said to be autoregressive, meaning that the output from one pass becomes the input for the next one. This loop continues until the model predicts the next token to be the EOS token, at which point the model can stop.</p>

<h3 id="system-messages"><span class="me-2">System Messages</span><a href="#system-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>System messages (also called System Prompts) define how the model should behave. They serve as persistent instructions, guiding every subsequent interaction.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>system_message = {
    "role": "system",
    "content": "You are a professional customer service agent. Always be polite, clear, and helpful."
}
</pre></td></tr></tbody></table></code></div></div>

<p>When using Agents, the System Message also gives information about the available tools, provides instructions to the model on how to format the actions to take, and includes guidelines on how the thought process should be segmented.</p>

<h3 id="conversations-user-and-assistant-messages"><span class="me-2">Conversations: User and Assistant Messages</span><a href="#conversations-user-and-assistant-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A conversation consists of alternating messages between a Human (user) and an LLM (assistant).</p>

<p>Chat templates help maintain context by preserving conversation history, storing previous exchanges between the user and the assistant. This leads to more coherent multi-turn conversations.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>conversation = [
    {"role": "user", "content": "I need help with my order"},
    {"role": "assistant", "content": "I'd be happy to help. Could you provide your order number?"},
    {"role": "user", "content": "It's ORDER-123"},
]
</pre></td></tr></tbody></table></code></div></div>
<p>For example, this is how the SmolLM2 chat template would format the previous exchange into a prompt:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>&lt;|im_start|&gt;system
You are a helpful AI assistant named SmolLM, trained by Hugging Face&lt;|im_end|&gt;
&lt;|im_start|&gt;user
I need help with my order&lt;|im_end|&gt;
&lt;|im_start|&gt;assistant
I'd be happy to help. Could you provide your order number?&lt;|im_end|&gt;
&lt;|im_start|&gt;user
It's ORDER-123&lt;|im_end|&gt;
&lt;|im_start|&gt;assistant
</pre></td></tr></tbody></table></code></div></div>
<p>However, the same conversation would be translated into the following prompt when using Llama 3.2:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>&lt;|begin_of_text|&gt;&lt;|start_header_id|&gt;system&lt;|end_header_id|&gt;

Cutting Knowledge Date: December 2023
Today Date: 10 Feb 2025

&lt;|eot_id|&gt;&lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;

I need help with my order&lt;|eot_id|&gt;&lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;

I'd be happy to help. Could you provide your order number?&lt;|eot_id|&gt;&lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;

It's ORDER-123&lt;|eot_id|&gt;&lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;
</pre></td></tr></tbody></table></code></div></div>

<h3 id="chat-templates"><span class="me-2">Chat-Templates</span><a href="#chat-templates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Chat templates are essential for structuring conversations between language models and users. They guide how message exchanges are formatted into a single prompt.</p>

<h4 id="base-models-vs-instruct-models"><span class="me-2">Base Models vs. Instruct Models</span><a href="#base-models-vs-instruct-models" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>A Base Model is trained on raw text data to predict the next token.</p>

<p>An Instruct Model is fine-tuned specifically to follow instructions and engage in conversations. For example, SmolLM2-135M is a base model, while SmolLM2-135M-Instruct is its instruction-tuned variant.</p>

<p>To make a Base Model behave like an instruct model, we need to format our prompts in a consistent way that the model can understand. This is where chat templates come in.</p>

<p>To make a Base Model behave like an instruct model, we need to format our prompts in a consistent way that the model can understand. This is where chat templates come in.</p>

<p>It’s important to note that a base model could be fine-tuned on different chat templates, so when we’re using an instruct model we need to make sure we’re using the correct chat template.</p>

<p>Because each instruct model uses different conversation formats and special tokens, chat templates are implemented to ensure that we correctly format the prompt the way each model expects.</p>

<p>Below is a simplified version of the SmolLM2-135M-Instruct chat template:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></div></div>

<p>Given these messages:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>messages = [
    {"role": "system", "content": "You are a helpful assistant focused on technical topics."},
    {"role": "user", "content": "Can you explain what a chat template is?"},
    {"role": "assistant", "content": "A chat template structures conversations between users and AI models..."},
    {"role": "user", "content": "How do I use it ?"},
]
</pre></td></tr></tbody></table></code></div></div>

<p>The chat template will format them as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>&lt;|im_start|&gt;system
You are a helpful assistant focused on technical topics.&lt;|im_end|&gt;
&lt;|im_start|&gt;user
Can you explain what a chat template is?&lt;|im_end|&gt;
&lt;|im_start|&gt;assistant
A chat template structures conversations between users and AI models...&lt;|im_end|&gt;
&lt;|im_start|&gt;user
How do I use it ?&lt;|im_end|&gt;
</pre></td></tr></tbody></table></code></div></div>
<p>The transformers library will take care of chat templates for you as part of the tokenization process.</p>

<h4 id="messages-to-prompt"><span class="me-2">Messages to prompt</span><a href="#messages-to-prompt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>The easiest way to ensure your LLM receives a conversation correctly formatted is to use the chat_template from the model’s tokenizer.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>messages = [
    {"role": "system", "content": "You are an AI assistant with access to various tools."},
    {"role": "user", "content": "Hi !"},
    {"role": "assistant", "content": "Hi human, what can help you with ?"},
]
</pre></td></tr></tbody></table></code></div></div>

<p>To convert the previous conversation into a prompt, we load the tokenizer and call apply_chat_template:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("HuggingFaceTB/SmolLM2-1.7B-Instruct")
rendered_prompt = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)
</pre></td></tr></tbody></table></code></div></div>

<p>The rendered_prompt returned by this function is now ready to use as the input for the model you chose!</p>

<h2 id="what-are-tools"><span class="me-2">What are Tools?</span><a href="#what-are-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>One crucial aspect of AI Agents is their ability to take actions. As we saw, this happens through the use of Tools.</p>

<p>By giving your Agent the right Tools—and clearly describing how those Tools work—you can dramatically increase what your AI can accomplish.A</p>

<p>Tool is a function given to the LLM. This function should fulfill a clear objective. you can in fact create a tool for any use case! For instance, if you need to perform arithmetic, giving a calculator tool to your LLM will provide better results than relying on the native capabilities of the model.</p>

<p>For instance, if you need to perform arithmetic, giving a calculator tool to your LLM will provide better results than relying on the native capabilities of the model. For instance, if you ask an LLM directly (without a search tool) for today’s weather, the LLM will potentially hallucinate random weather.</p>

<p>A Tool contains:</p>
<ul>
  <li>A textual description of what the function does.</li>
  <li>A Callable (something to perform an action).</li>
  <li>Arguments with typings.</li>
  <li>(Optional) Outputs with typings.</li>
</ul>

<h3 id="how-do-tools-work"><span class="me-2">How do tools work?</span><a href="#how-do-tools-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>LLMs, as we saw, can only receive text inputs and generate text outputs. They have no way to call tools on their own. What we mean when we talk about providing tools to an Agent, is that we teach the LLM about the existence of tools, and ask the model to generate text that will invoke tools when it needs to. For example, if we provide a tool to check the weather at a location from the Internet, and then ask the LLM about the weather in Paris, the LLM will recognize that question as a relevant opportunity to use the “weather” tool we taught it about. The LLM will generate text, in the form of code, to invoke that tool. It is the responsibility of the Agent to parse the LLM’s output, recognize that a tool call is required, and invoke the tool on the LLM’s behalf. The output from the tool will then be sent back to the LLM, which will compose its final response for the user.</p>

<h4 id="how-do-we-give-tools-to-an-llm"><span class="me-2">How do we give tools to an LLM?</span><a href="#how-do-we-give-tools-to-an-llm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Use the system prompt to provide textual descriptions of available tools to the model:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>system_message = """You are a helpful assistant with access to the following tools: weather, calculator, and search. You can use these tools:
{tool_description}
"""
</pre></td></tr></tbody></table></code></div></div>

<p>We will implement a simplified calculator tool that will just multiply two integers. This could be our Python implementation:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>def calculator(a: int, b: int) -&gt; int:
    """Multiply two integers."""
    return a * b

print(calculator.to_string())
</pre></td></tr></tbody></table></code></div></div>

<p>So our tool is called calculator, it multiplies two integers, and it requires the following inputs:</p>

<p>a (int): An integer.
b (int): An integer.
The output of the tool is another integer number that we can describe like this:</p>

<p>(int): The product of a and b.
All of these details are important. Let’s put them together in a text string that describes our tool for the LLM to understand.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Tool Name: calculator, Description: Multiply two integers., Arguments: a: int, b: int, Outputs: int
</pre></td></tr></tbody></table></code></div></div>

<p>This textual description is what we want the LLM to know about the tool.</p>

<h4 id="auto-formatting-tool-sections"><span class="me-2">Auto-formatting Tool sections</span><a href="#auto-formatting-tool-sections" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Our tool was written in Python, and the implementation already provides everything we need:</p>

<ul>
  <li>A descriptive name of what it does: calculator</li>
  <li>A longer description, provided by the function’s docstring comment: Multiply two integers.</li>
  <li>The inputs and their type: the function clearly expects two ints.</li>
  <li>The type of the output.</li>
</ul>

<p>We could provide the Python source code as the specification of the tool for the LLM, but the way the tool is implemented does not matter. All that matters is its name, what it does, the inputs it expects and the output it provides.</p>

<p>We will leverage Python’s introspection features to leverage the source code and build a tool description automatically for us. All we need is that the tool implementation uses type hints, docstrings, and sensible function names. We will write some code to extract the relevant portions from the source code.</p>

<p>After we are done, we’ll only need to use a Python decorator to indicate that the calculator function is a tool:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>@tool
def calculator(a: int, b: int) -&gt; int:
    """Multiply two integers."""
    return a * b

print(calculator.to_string())
</pre></td></tr></tbody></table></code></div></div>

<p>With the tool decorator implementation, we will be able to retrieve the following text automatically from the source code:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Tool Name: calculator, Description: Multiply two integers., Arguments: a: int, b: int, Outputs: int
</pre></td></tr></tbody></table></code></div></div>

<p>This is a simplified example, but it shows the power of tools. We can now use the calculator tool in our system prompt:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
</pre></td><td class="rouge-code"><pre>class Tool:
    """
    A class representing a reusable piece of code (Tool).
    
    Attributes:
        name (str): Name of the tool.
        description (str): A textual description of what the tool does.
        func (callable): The function this tool wraps.
        arguments (list): A list of argument.
        outputs (str or list): The return type(s) of the wrapped function.
    """
    def __init__(self, 
                 name: str, 
                 description: str, 
                 func: callable, 
                 arguments: list,
                 outputs: str):
        self.name = name
        self.description = description
        self.func = func
        self.arguments = arguments
        self.outputs = outputs

    def to_string(self) -&gt; str:
        """
        Return a string representation of the tool, 
        including its name, description, arguments, and outputs.
        """
        args_str = ", ".join([
            f"{arg_name}: {arg_type}" for arg_name, arg_type in self.arguments
        ])
        
        return (
            f"Tool Name: {self.name},"
            f" Description: {self.description},"
            f" Arguments: {args_str},"
            f" Outputs: {self.outputs}"
        )

    def __call__(self, *args, **kwargs):
        """
        Invoke the underlying function (callable) with provided arguments.
        """
        return self.func(*args, **kwargs)

def tool(func):
    """
    A decorator that creates a Tool instance from the given function.
    """
    # Get the function signature
    signature = inspect.signature(func)
    
    # Extract (param_name, param_annotation) pairs for inputs
    arguments = []
    for param in signature.parameters.values():
        annotation_name = (
            param.annotation.__name__ 
            if hasattr(param.annotation, '__name__') 
            else str(param.annotation)
        )
        arguments.append((param.name, annotation_name))
    
    # Determine the return annotation
    return_annotation = signature.return_annotation
    if return_annotation is inspect._empty:
        outputs = "No return annotation"
    else:
        outputs = (
            return_annotation.__name__ 
            if hasattr(return_annotation, '__name__') 
            else str(return_annotation)
        )
    
    # Use the function's docstring as the description (default if None)
    description = func.__doc__ or "No description provided."
    
    # The function name becomes the Tool name
    name = func.__name__
    
    # Return a new Tool instance
    return Tool(
        name=name, 
        description=description, 
        func=func, 
        arguments=arguments, 
        outputs=outputs
    )
</pre></td></tr></tbody></table></code></div></div>

<p>The decorator description is injected in the system prompt. Taking the example with which we started this section, here is how it would look like after replacing the tools_description:</p>

<h2 id="understanding-ai-agents-through-the-thought-action-observation-cycle"><span class="me-2">Understanding AI Agents through the Thought-Action-Observation Cycle</span><a href="#understanding-ai-agents-through-the-thought-action-observation-cycle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Agents work in a continuous cycle of: thinking (Thought) → acting (Act) and observing (Observe).</p>

<p>Let’s break down these actions together:</p>

<ul>
  <li>Thought: The LLM part of the Agent decides what the next step should be.</li>
  <li>Action: The agent takes an action, by calling the tools with the associated arguments.</li>
  <li>Observation: The model reflects on the response from the tool.</li>
</ul>

<h3 id="the-thought-action-observation-cycle"><span class="me-2">The Thought-Action-Observation Cycle</span><a href="#the-thought-action-observation-cycle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In many Agent frameworks, the rules and guidelines are embedded directly into the system prompt, ensuring that every cycle adheres to a defined logic.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>system_message="""You are an AI assistant designed to help users efficiently and accurately. Your primary goal is to provide helpful, precise, and clear responses.

You have access to the following tools:
Tool Name: calculator, Description: Multiply two integers., Arguments: a: int, b: int, Outputs: int

You should think step by step in order to fulfill the objective with a reasoning devided in Thought/Action/Observation that can repeat multiple times if needed.

You should first reflect with ‘Thought: {your_thoughts}’ on the current situation, then (if necessary ), call a tool with the proper JSON formatting ‘Action: {JSON_BLOB}’,or you print your final answer starting with the prefix ‘Final Answer:’
"""
</pre></td></tr></tbody></table></code></div></div>

<h3 id="the-weather-agent"><span class="me-2">The weather Agent</span><a href="#the-weather-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A user asks the agent: “What’s the weather like in New York today?”
Alfred’s job is to answer this query using a weather API tool.</p>

<p>Thought: “The user needs current weather information for New York. I have access to a tool that fetches weather data. First, I need to call the weather API to get up-to-date details.”
Action: Based on its reasoning and the fact that Alfred knows about a get_weather tool, Alfred prepares a JSON-formatted command that calls the weather API tool.
Observation: After the tool call, Alfred receives an observation. This might be the raw weather data from the API such as: “Current weather in New York: partly cloudy, 15°C, 60% humidity.” This observation is then added to the prompt as additional context. It functions as real-world feedback, confirming whether the action succeeded and providing the needed details.
Updated thought: “Now that I have the weather data for New York, I can compile an answer for the user.”
Final Action: 
Thought: I have the weather data now. The current weather in New York is partly cloudy with a temperature of 15°C and 60% humidity.”
Final answer : The current weather in New York is partly cloudy with a temperature of 15°C and 60% humidity.</p>

<h3 id="react-cycle"><span class="me-2">ReAct cycle</span><a href="#react-cycle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The interplay of Thought, Action, and Observation empowers AI agents to solve complex tasks iteratively.
By understanding and applying these principles, you can design agents that not only reason about their tasks but also effectively utilize external tools to complete them, all while continuously refining their output based on environmental feedback.</p>

<h2 id="thought-internal-reasoning-and-the-re-act-approach"><span class="me-2">Thought: Internal Reasoning and the Re-Act Approach</span><a href="#thought-internal-reasoning-and-the-re-act-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Type of Thought:</p>
<ul>
  <li>Planning: “I need to break this task into three steps: 1) gather data, 2) analyze trends, 3) generate report”</li>
  <li>Analysis: “Based on the error message, the issue appears to be with the database connection parameters”</li>
  <li>Decision Making: “Given the user’s budget constraints, I should recommend the mid-tier option”</li>
  <li>Problem Solving: “To optimize this code, I should first profile it to identify bottlenecks”</li>
  <li>Memory Integration: “The user mentioned their preference for Python earlier, so I’ll provide examples in Python”</li>
  <li>Self-Reflection: “My last approach didn’t work well, I should try a different strategy”</li>
  <li>Goal Setting: “To complete this task, I need to first establish the acceptance criteria”</li>
  <li>Prioritization: “The security vulnerability should be addressed before adding new features”</li>
</ul>

<h3 id="action-external-tool-invocation"><span class="me-2">Action: External Tool Invocation</span><a href="#action-external-tool-invocation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Type of Action:</p>
<ul>
  <li>API Call: “I need to call the weather API to get the current weather in New York”</li>
  <li>Function Call: “I need to call the get_weather function with the appropriate arguments”</li>
</ul>

<h3 id="the-re-act-approach"><span class="me-2">The Re-Act Approach</span><a href="#the-re-act-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A key method is the ReAct approach, which is the concatenation of “Reasoning” (Think) with “Acting” (Act).</p>

<p>ReAct is a simple prompting technique that appends “Let’s think step by step” before letting the LLM decode the next tokens.</p>

<p>Indeed, prompting the model to think “step by step” encourages the decoding process toward next tokens that generate a plan, rather than a final solution, since the model is encouraged to decompose the problem into sub-tasks.</p>

<p>This allows the model to consider sub-steps in more detail, which in general leads to less errors than trying to generate the final solution directly.</p>

<p>Models like Deepseek R1 or OpenAI’s o1, which have been fine-tuned to “think before answering”.
These models have been trained to always include specific thinking sections (enclosed between <think> and </think> special tokens). This is not just a prompting technique like ReAct, but a training method where the model learns to generate these sections after analyzing thousands of examples that show what we expect it to do.</p>

<h2 id="actions-enabling-the-agent-to-engage-with-its-environment"><span class="me-2">Actions: Enabling the Agent to Engage with Its Environment</span><a href="#actions-enabling-the-agent-to-engage-with-its-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Actions are the concrete steps an AI agent takes to interact with its environment.</p>

<p>Whether it’s browsing the web for information or controlling a physical device, each action is a deliberate operation executed by the agent.</p>

<p>Types of Agent Actions:</p>
<ul>
  <li>JSON Agent: The Action to take is specified in JSON format.</li>
  <li>Code Agent: The Agent writes a code block that is interpreted externally.</li>
  <li>Function-calling Agent: It is a subcategory of the JSON Agent which has been fine-tuned to generate a new message for each action.</li>
</ul>

<p>Type of Action:</p>
<ul>
  <li>Information Gathering: Performing web searches, querying databases, or retrieving documents.</li>
  <li>Tool Usage: Making API calls, running calculations, and executing code.</li>
  <li>Environment Interaction: Manipulating digital interfaces or controlling physical devices.</li>
  <li>Communication: Engaging with users via chat or collaborating with other agents.</li>
</ul>

<p>One crucial part of an agent is the ability to STOP generating new tokens when an action is complete, and that is true for all formats of Agent: JSON, code, or function-calling. This prevents unintended output and ensures that the agent’s response is clear and precise.</p>

<h3 id="the-stop-and-parse-approach"><span class="me-2">The Stop and Parse Approach</span><a href="#the-stop-and-parse-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>One key method for implementing actions is the stop and parse approach. This method ensures that the agent’s output is structured and predictable:</p>

<p>Generation in a Structured Format: The agent outputs its intended action in a clear, predetermined format (JSON or code).
Halting Further Generation: Once the action is complete, the agent stops generating additional tokens. This prevents extra or erroneous output.
Parsing the Output: An external parser reads the formatted action, determines which Tool to call, and extracts the required parameters.</p>

<h3 id="code-agents"><span class="me-2">Code Agents</span><a href="#code-agents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The idea is: instead of outputting a simple JSON object, a Code Agent generates an executable code block—typically in a high-level language like Python.</p>

<p>For example, a Code Agent tasked with fetching the weather might generate the following Python snippet:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre># Code Agent Example: Retrieve Weather Information
def get_weather(city):
    import requests
    api_url = f"https://api.weather.com/v1/location/{city}?apiKey=YOUR_API_KEY"
    response = requests.get(api_url)
    if response.status_code == 200:
        data = response.json()
        return data.get("weather", "No weather information available")
    else:
        return "Error: Unable to fetch weather data."

# Execute the function and prepare the final answer
result = get_weather("New York")
final_answer = f"The current weather in New York is: {result}"
print(final_answer)
</pre></td></tr></tbody></table></code></div></div>

<h2 id="observe-integrating-feedback-to-reflect-and-adapt"><span class="me-2">Observe: Integrating Feedback to Reflect and Adapt</span><a href="#observe-integrating-feedback-to-reflect-and-adapt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Observations are how an Agent perceives the consequences of its actions.</p>

<p>They are signals from the environment—whether it’s data from an API, error messages, or system logs—that guide the next cycle of thought.</p>

<p>In the observation phase, the agent:</p>

<ul>
  <li>Collects Feedback: Receives data or confirmation that its action was successful (or not).</li>
  <li>Appends Results: Integrates the new information into its existing context, effectively updating its memory.</li>
  <li>Adapts its Strategy: Uses this updated context to refine subsequent thoughts and actions.</li>
</ul>

<p>Type of Observation:</p>
<ul>
  <li>System Feedback: Error messages, success notifications, status codes</li>
  <li>Data Changes: Database updates, file system modifications, state changes</li>
  <li>Environmental Data: Sensor readings, system metrics, resource usage</li>
  <li>Response Analysis: API responses, query results, computation outputs</li>
  <li>Time-based Events: Deadlines reached, scheduled tasks completed</li>
</ul>

<h2 id="dummy-agent-library"><span class="me-2">Dummy Agent Library</span><a href="#dummy-agent-library" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="jupyter-notebook" style="position: relative; width: 100%; margin: 0 auto;">
  <div class="jupyter-notebook-iframe-container">
    <iframe src="../../assets/2025-02/building_agents/dummy_agent_library.ipynb.html" style="position: absolute; top: 0; left: 0; border-style: none;" width="100%" height="100%" onload="this.parentElement.style.paddingBottom = (this.contentWindow.document.documentElement.scrollHeight + 10) + 'px'"></iframe>
  </div>
</div>

<h2 id="lets-create-our-first-agent-using-smolagents"><span class="me-2">Let’s Create Our First Agent Using smolagents</span><a href="#lets-create-our-first-agent-using-smolagents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="what-is-smolagents"><span class="me-2">What is smolagents?</span><a href="#what-is-smolagents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Smolagents is a library that focuses on codeAgent, a kind of agent that performs “Actions” through code blocks, and then “Observes” results by executing the code.</p>

<p>Lightweight library is designed for simplicity, but it abstracts away much of the complexity of building an Agent, allowing you to focus on designing your agent’s behavior.</p>

<p>We provided our agent with an Image generation tool and asked it to generate an image of a cat.</p>

<p>The agent inside smolagents is going to have the same behaviors as the custom one we built previously: it’s going to think, act and observe in cycle until it reaches a final answer.</p>

<h3 id="lets-build-our-agent"><span class="me-2">Let’s build our Agent!</span><a href="#lets-build-our-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="jupyter-notebook" style="position: relative; width: 100%; margin: 0 auto;">
  <div class="jupyter-notebook-iframe-container">
    <iframe src="../../assets/2025-02/building_agents/smol_agent.ipynb.html" style="position: absolute; top: 0; left: 0; border-style: none;" width="100%" height="100%" onload="this.parentElement.style.paddingBottom = (this.contentWindow.document.documentElement.scrollHeight + 10) + 'px'"></iframe>
  </div>
</div>

<h2 id="fine-tuning-llm-for-function-calling"><span class="me-2">Fine tuning LLM for function calling</span><a href="#fine-tuning-llm-for-function-calling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Function-calling is a way for an LLM to take actions on its environment. It was first introduced in GPT-4, and was later reproduced in other models.</p>

<p>Just like the tools of an Agent, function-calling gives the model the capacity to take an action on its environment. However, the function calling capacity is learned by the model, and relies less on prompting than other agents techniques.</p>

<p>During Unit 1, the Agent didn’t learn to use the Tools, we just provided the list, and we relied on the fact that the model was able to generalize on defining a plan using these Tools.</p>

<p><a href="https://huggingface.co/learn/nlp-course/chapter11/4?fw=pt">Huggingface course</a></p>

<div class="jupyter-notebook" style="position: relative; width: 100%; margin: 0 auto;">
  <div class="jupyter-notebook-iframe-container">
    <iframe src="https://colab.research.google.com/#fileId=https%3A//huggingface.co/agents-course/notebooks/blob/main/bonus-unit1/bonus-unit1.ipynb.html" style="position: absolute; top: 0; left: 0; border-style: none;" width="100%" height="100%" onload="this.parentElement.style.paddingBottom = (this.contentWindow.document.documentElement.scrollHeight + 10) + 'px'"></iframe>
  </div>
</div>

<p>Start from <code class="language-plaintext highlighter-rouge">https://huggingface.co/google/gemma-2-2b-it</code>, a model that has been trained for instruction following (instruction tuned). Instruction tuned models introduce extra tokens to the vocabulary to help the model understand the instructions; examples are <code class="language-plaintext highlighter-rouge">&lt;start_of_turn&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;end_of_turn&gt;</code> in the case of gemma.</p>

<p>The tokenizer provides a built-in chat template that can be used to format the conversation as a list of messages. As an example, the following chart:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>chat = [
    { "role": "user", "content": "Write a hello world program" },
]
</pre></td></tr></tbody></table></code></div></div>

<p>Ran through the tokenizer’s chat template:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>prompt = tokenizer.apply_chat_template(chat, tokenize=False, add_generation_prompt=True)
</pre></td></tr></tbody></table></code></div></div>

<p>Will output:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>&lt;bos&gt;&lt;start_of_turn&gt;user
Write a hello world program&lt;end_of_turn&gt;
&lt;start_of_turn&gt;model
</pre></td></tr></tbody></table></code></div></div>

<h3 id="nousresearchhermes-function-calling-v1-dataset"><span class="me-2">NousResearch/hermes-function-calling-v1 DataSet</span><a href="#nousresearchhermes-function-calling-v1-dataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A popular Dataset for function calling with 11578 examples. Here’s an example:</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"system"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"You are a function calling AI model. You are provided with function signatures within &lt;tools&gt; &lt;/tools&gt; XML tags. You may call one or more functions to assist with the user query. Don't make assumptions about what values to plug into functions. &lt;tools&gt; [{'type': 'function', 'function': {'name': 'get_camera_live_feed', 'description': 'Retrieves the live feed from a specified security camera.', 'parameters': {'type': 'object', 'properties': {'camera_id': {'type': 'string', 'description': 'The unique identifier for the camera.'}, 'stream_quality': {'type': 'string', 'description': 'The desired quality of the live stream.', 'enum': ['720p', '1080p', '4k']}}, 'required': ['camera_id']}}}, {'type': 'function', 'function': {'name': 'list_all_cameras', 'description': 'Lists all the security cameras connected to the home network.', 'parameters': {'type': 'object', 'properties': {'include_offline': {'type': 'boolean', 'description': 'Whether to include cameras that are currently offline.', 'default': False}}, 'required': []}}}, {'type': 'function', 'function': {'name': 'record_camera_feed', 'description': 'Starts recording the live feed from a specified security camera.', 'parameters': {'type': 'object', 'properties': {'camera_id': {'type': 'string', 'description': 'The unique identifier for the camera.'}, 'duration': {'type': 'integer', 'description': 'The duration in minutes for which to record the feed.', 'default': 60}}, 'required': ['camera_id']}}}, {'type': 'function', 'function': {'name': 'get_recorded_feed', 'description': 'Retrieves a previously recorded feed from a specified security camera.', 'parameters': {'type': 'object', 'properties': {'camera_id': {'type': 'string', 'description': 'The unique identifier for the camera.'}, 'start_time': {'type': 'string', 'description': 'The start time of the recording to retrieve, in ISO 8601 format.'}, 'end_time': {'type': 'string', 'description': 'The end time of the recording to retrieve, in ISO 8601 format.'}}, 'required': ['camera_id', 'start_time', 'end_time']}}}, {'type': 'function', 'function': {'name': 'pan_tilt_camera', 'description': 'Controls the pan and tilt functions of a PTZ (Pan-Tilt-Zoom) security camera.', 'parameters': {'type': 'object', 'properties': {'camera_id': {'type': 'string', 'description': 'The unique identifier for the PTZ camera.'}, 'pan_angle': {'type': 'integer', 'description': 'The angle in degrees to pan the camera. Positive values pan right, negative values pan left.'}, 'tilt_angle': {'type': 'integer', 'description': 'The angle in degrees to tilt the camera. Positive values tilt up, negative values tilt down.'}}, 'required': ['camera_id', 'pan_angle', 'tilt_angle']}}}] &lt;/tools&gt; For each function call return a json object with function name and arguments within &lt;tool_call&gt; &lt;/tool_call&gt; tags with the following schema: &lt;tool_call&gt; {'arguments': &lt;args-dict&gt;, 'name': &lt;function-name&gt;} &lt;/tool_call&gt; "</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"human"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I've recently installed a new security system at my home, and I want to ensure everything is functioning as it should. Specifically, I'd like to start by checking the live feed from the camera located at the front door to monitor any activity. The camera has a unique identifier, which I've already configured to be "</span><span class="err">front_door.</span><span class="s2">" I'd prefer to view the live stream in high definition, so a 1080p quality would be ideal. Could you please call the appropriate function to retrieve the live feed from my front door camera in 1080p quality and provide me with the link to the stream? Following this, I would also like to record the live feed from this camera for the next 30 minutes. This is to test the recording feature and to keep an archived copy for security purposes. Please initiate the recording function for the "</span><span class="err">front_door</span><span class="s2">" camera with a recording duration of 30 minutes. Lastly, as part of my routine surveillance checks, I need to review footage from yesterday between 3 PM and 5 PM. The camera "</span><span class="err">front_garden</span><span class="s2">" should have the recording for that period. I need to retrieve this specific recorded feed. The start time for the recording was at 15:00 on April 22, 2023, and it ended at 17:00 on the same day. To summarize, I request the execution of the following functions with the provided details: 1. Retrieve the live feed from the "</span><span class="err">front_door</span><span class="s2">" camera at 1080p quality. 2. Start a 30-minute recording of the live feed from the "</span><span class="err">front_door</span><span class="s2">" camera. 3. Retrieve the recorded feed from the "</span><span class="err">front_garden</span><span class="s2">" camera, focusing on the time period between 15:00 and 17:00 on April 22, 2023. Thank you for assisting with the management of my home security camera feeds."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gpt"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;tool_call&gt; {'arguments': {'camera_id': 'front_door', 'stream_quality': '1080p'}, 'name': 'get_camera_live_feed'} &lt;/tool_call&gt; &lt;tool_call&gt; {'arguments': {'camera_id': 'front_door', 'duration': 30}, 'name': 'record_camera_feed'} &lt;/tool_call&gt; &lt;tool_call&gt; {'arguments': {'camera_id': 'front_garden', 'start_time': '2023-04-22T15:00:00Z', 'end_time': '2023-04-22T17:00:00Z'}, 'name': 'get_recorded_feed'} &lt;/tool_call&gt; "</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Now, this dataset does not contain the thinking part, so we need to add it. See next.</p>

<h3 id="hermes-function-calling-thinking-v1-dataset"><span class="me-2">hermes-function-calling-thinking-V1 DataSet</span><a href="#hermes-function-calling-thinking-v1-dataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Contains a single split called “train” with 3570 examples:</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"You are a function calling AI model. You are provided with function signatures within &lt;tools&gt;&lt;/tools&gt; XML tags.You may call one or more functions to assist with the user query. Don't make assumptions about what values to plug into functions.Here are the available tools:&lt;tools&gt; [{'type': 'function', 'function': {'name': 'get_stock_price', 'description': 'Get the current stock price of a company', 'parameters': {'type': 'object', 'properties': {'company': {'type': 'string', 'description': 'The name of the company'}}, 'required': ['company']}}}, {'type': 'function', 'function': {'name': 'get_movie_details', 'description': 'Get details about a movie', 'parameters': {'type': 'object', 'properties': {'title': {'type': 'string', 'description': 'The title of the movie'}}, 'required': ['title']}}}] &lt;/tools&gt;Use the following pydantic model json schema for each tool call you will make: {'title': 'FunctionCall', 'type': 'object', 'properties': {'arguments': {'title': 'Arguments', 'type': 'object'}, 'name': {'title': 'Name', 'type': 'string'}}, 'required': ['arguments', 'name']}For each function call return a json object with function name and arguments within &lt;tool_call&gt;&lt;/tool_call&gt; XML tags as follows:</span><span class="se">\n</span><span class="s2">&lt;tool_call&gt;</span><span class="se">\n</span><span class="s2">{tool_call}</span><span class="se">\n</span><span class="s2">&lt;/tool_call&gt;"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"system"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi, can you tell me the current stock price of Apple?"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"human"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;think&gt;Alright, the user asked for the current stock price of Apple. Looking at the tools available, there's a function called get_stock_price which exactly fits this request. I'll need to call this function with the parameter company set to 'Apple' to retrieve the information the user is asking for. This seems like the most straightforward and appropriate action to take.</span><span class="se">\n</span><span class="s2">&lt;/think&gt;&lt;tool_call&gt;</span><span class="se">\n</span><span class="s2">{'name': 'get_stock_price', 'arguments': {'company': 'Apple'}}</span><span class="se">\n</span><span class="s2">&lt;/tool_call&gt;"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"model"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;tool_response&gt;</span><span class="se">\n</span><span class="s2">{'stock_price': '$150.75'}</span><span class="se">\n</span><span class="s2">&lt;/tool_response&gt;"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tool"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The current stock price of Apple is $150.75."</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"model"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"That's great. Can you also tell me the stock price for Microsoft?"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"human"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;think&gt;Alright, let me try to figure out how to handle this user's request. The user first asked about Apple's stock price, and I responded by calling the get_stock_price function with 'Apple' as the argument. The tool provided the price, and I passed that information back to the user.</span><span class="se">\n\n</span><span class="s2">Now, the user is asking for the stock price of Microsoft. I need to determine the appropriate action here. Looking at the tools available, there's still the get_stock_price function, which is designed to fetch current stock prices. Since the user is requesting another company's stock price, it makes sense to use the same function again but with the company name changed to Microsoft. </span><span class="se">\n\n</span><span class="s2">I shouldn't assume any other tools are needed because the available functions are specifically tailored for stock prices and movie details. In this case, the relevant function is get_stock_price. I should ensure that the function is called with the correct parameter, 'Microsoft' in this case, to retrieve the accurate information the user is seeking. This approach is efficient and aligns directly with the user's request without making unnecessary assumptions or using unrelated tools.</span><span class="se">\n</span><span class="s2">&lt;/think&gt;&lt;tool_call&gt;</span><span class="se">\n</span><span class="s2">{'name': 'get_stock_price', 'arguments': {'company': 'Microsoft'}}</span><span class="se">\n</span><span class="s2">&lt;/tool_call&gt;"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"model"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;tool_response&gt;</span><span class="se">\n</span><span class="s2">{'stock_price': '$210.22'}</span><span class="se">\n</span><span class="s2">&lt;/tool_response&gt;"</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tool"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The current stock price of Microsoft is $210.22."</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"model"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thank you for the information."</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"human"</span><span class="w"> 
    </span><span class="p">},</span><span class="w"> 
    </span><span class="p">{</span><span class="w"> 
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"You're welcome! If you have any other questions, feel free to ask."</span><span class="p">,</span><span class="w"> 
        </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"model"</span><span class="w"> 
    </span><span class="p">}</span><span class="w"> 
</span><span class="p">]</span><span class="w">

</span></pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Agents%20Building%20Blocks%20-%20Laurentiu%20SOICA&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAgents-Building-blocks%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Agents%20Building%20Blocks%20-%20Laurentiu%20SOICA&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAgents-Building-blocks%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAgents-Building-blocks%2F&text=Agents%20Building%20Blocks%20-%20Laurentiu%20SOICA" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ai-applications-observability/">AI Applications Observability</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/mcp-servers/">MCP Servers</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/how-to-build-agents-with-llms/">How to build agents with LLMs</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Function-Calling-with-Mistral/">Function Calling with Mistral</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Agents-Building-blocks/">Agents Building Blocks</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/neuralnetworks/">neuralnetworks</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/agents/">agents</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/probabilities/">probabilities</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rnn/">rnn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deepseek/">deepseek</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/transformers/">transformers</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/autoencoders/">autoencoders</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/backpropagation/">backpropagation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bert/">bert</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->


























            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/ChatGPT-like-systems/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>ChatGPT-like systems</p>
    </a>
  

  
    <a
      href="/posts/Function-Calling-with-Mistral/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Function Calling with Mistral</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/lsoica">Laurentiu SOICA</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/neuralnetworks/">neuralnetworks</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/agents/">agents</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/probabilities/">probabilities</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rnn/">rnn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deepseek/">deepseek</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/transformers/">transformers</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/autoencoders/">autoencoders</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/backpropagation/">backpropagation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bert/">bert</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

